<!doctype html>
<html lang="en" data-framework="jquery">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>jQuery ï¿½ TodoMVC</title>
	<style>
div.fixed {width:50px; height:50px; border:solid thin blue;}
div.flex {height:50px; border:solid thin orange;}
div.hbox {height:60px;}
	</style>
</head>
<body>
	<section id="todoapp">
	  <script type='text/custom-tag'>
	    <hbox class='hbox'>
        <div class='fixed'>BOX1</div>
        <div class='fixed'>BOX2</div>
        <div class='flex' flex='true'>BOX3</div>
        <div class='fixed'>BOX4</div>
      </hbox>
  	</script>
	</section>
	<script src="bower_components/jquery/jquery.js"></script>
  <script src="bower_components/log4javascript/log4javascript.js"></script>
  <script>
    var log = log4javascript.getDefaultLogger();
    log.debug("DEBUG - Enabled");
    log.debug("INFO - Enabled");
  </script>
  <script src="js/Class.js"></script>
  <script src="js/tags.js"></script>
  <script>

    Tags.extend({
      tag:'helloWorld',
      extend:'view',
      renderText: function() {
        var context = this.renderOpen("div");
        this.addContent(context,"<div>BEFORE</div>");
        this.renderBody(context);
        this.addContent(context,"<div>AFTER</div>");
        this.renderClose(context);
        return context.buf;
      }
    });
    
    Tags.extend({
      tag:'hbox',
      extend:'view',
      renderText: function() {
        return this.renderAs('div');
      },
      activate: function() {
        this._super();
        var left = 0;
        var flexItem = null;
        if (this.el.css('position') != 'absolute') this.el.css('position','relative');
        for (var n=0; n<this.content.length; n++) {
          var item = this.content[n];
          if (!Tags.isTag(item)) continue;  // ignore non-tags
          var itemEl = item.el;
          itemEl.css({'position':'absolute','left':left+'px'});
          if (item.flex) {
            flexItem = item;
            break;
          }
          left += itemEl.outerWidth();
        }
        if (flexItem) {
          var right = 0;
          for (var n=this.content.length; n>0; n--) {
            var item = this.content[n-1];
            var itemEl = item.el;
            if (!Tags.isTag(item)) continue;  // ignore non-tags
            itemEl.css({'position':'absolute','right':right+'px'});
            if (item.flex) break;
            right += itemEl.outerWidth();
          }
        }
      }
    });
  </script>
</body>
</html>